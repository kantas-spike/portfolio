<!doctype html>
<html><head>
    <title>
        Pythonプロジェクトのパッケージを管理する | kanta&#39;s spike
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
<link
  rel="preload"
  href="/portfolio/fonts/notosansjp-bold.woff2"
  as="font"
  type="font/woff2"
  crossorigin="anonymous"
/>

<link
  rel="preload"
  href="/portfolio/fonts/notosansjp-regular.woff2"
  as="font"
  type="font/woff2"
  crossorigin="anonymous"
/>


<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Noto+Emoji:wght@400;500;700&family=Noto+Sans+JP:wght@400;700&display=swap"
  rel="stylesheet"
/>
<link rel="stylesheet" href="/portfolio/css/fonts.598ae1b8a36eef149fd604bc4a326391fe472bc4628f92811ed047364d446748.css">
    <link rel="stylesheet" href="/portfolio/css/theme.min.c1e28e172e1a969472a73bd59d6d066cf677bd0a251db98e504f6f310d61ff36.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer" /><link rel="stylesheet" href="/portfolio/css/syntax.min.53132d5ecb321e785c36c5e94d619a0e0e5e50abd5435b10c105ebd046929b7a.css">
<link rel="icon" type="image/png" sizes="512x512" href="/portfolio/icon512.png" />
 
<link rel="icon" type="image/png" sizes="192x192" href="/portfolio/icon192.png" />
 
<link rel="apple-touch-icon" sizes="180x180" href="/portfolio/icon180.png" />
 
<link rel="icon" type="image/png" sizes="32x32" href="/portfolio/icon32.png" />
 
<link rel="icon" type="image/svg+xml" href="/portfolio/icon.svg" />
 
<link rel="manifest" href="/portfolio/site.webmanifest" />


</head><body class="bg-background text-primary-dark pb-4"><header class="bg-primary-dark text-site_title text-6xl font-serif font-extrabold px-4 py-3">
    <h1 class="container mx-auto px-4"><a href="https://kantas-spike.github.io/portfolio/">kanta&#39;s spike</a></h1>
</header>
<input type="checkbox" name="burger_cbx" id="burger_cbx">
<label for="burger_cbx" class="burger_label">
    <span class="burger_icon"><svg version="1.1" viewBox="0 0 12.7 12.7" xmlns="http://www.w3.org/2000/svg">
 <g>
  <rect x="1.0369" y="2.1007" width="10.634" height="1.0426" ry=".5213"/>
  <rect x="1.0369" y="4.571" width="10.634" height="1.0426" ry=".5213"/>
  <rect x="1.0369" y="7.0413" width="10.634" height="1.0426" ry=".5213"/>
  <rect x="1.0369" y="9.5115" width="10.634" height="1.0426" ry=".5213"/>
 </g>
</svg>
</span>
</label>
<label for="burger_cbx" class="close_label">
    <span class="close_icon"><svg version="1.1" viewBox="0 0 12.7 12.7" xmlns="http://www.w3.org/2000/svg">
 <rect transform="rotate(45.535)" x="3.6678" y="-.6148" width="10.634" height="1.0426" ry=".5213"/>
 <rect transform="rotate(135.53)" x="-5.4104" y="-9.5059" width="10.634" height="1.0426" ry=".5213"/>
</svg>
</span>
</label>
<div class="nav_area">
    <nav class="container mx-auto bg-primary text-on-primary text-center flex flex-col md:flex-row justify-start">
            <a href="/portfolio/" class="flex-1 text-center no-underline text-on-primary py-2 hover:font-bold">Home</a>
            <a href="/portfolio/til" class="box-border flex-1 text-center no-underline bg-primary-light text-on-primary-light font-bold py-2">TIL</a>
            <a href="/portfolio/dialogues" class="flex-1 text-center no-underline text-on-primary py-2 hover:font-bold">Dialogues</a>
            <a href="/portfolio/articles" class="flex-1 text-center no-underline text-on-primary py-2 hover:font-bold">Articles</a>
            <a href="/portfolio/mytools" class="flex-1 text-center no-underline text-on-primary py-2 hover:font-bold">My Tools</a>
            <a href="/portfolio/ihc" class="flex-1 text-center no-underline text-on-primary py-2 hover:font-bold">IHC</a>
            <a href="/portfolio/tags" class="flex-1 text-center no-underline text-on-primary py-2 hover:font-bold">Tags</a>
        <div class="flex-none" id="search_menu"></div>
    </nav>
</div>
<main id="content" class="container mx-auto bg-surface pt-4 pb-8">
<div class="area_border px-4 py-3 mx-4 md:mx-auto pb-4 max-w-[60rem]">
  



<div class="mb-4">
    <h3 class="border-b-4 border-primary-dark text-primary-dark text-xl font-bold tracking-wider pl-[1em] -indent-[1ex]"><i class="fa-solid fa-circle-info"></i> <a href="https://kantas-spike.github.io/portfolio/til/2023/02/47-use-poetry/">Pythonプロジェクトのパッケージを管理する</a></h3>
    <div class="flex justify-between mt-1 mx-2">
        <div>
            <ul class="flex gap-2 justify-end">
            
            <li><a class="tag_link text-sm" href="https://kantas-spike.github.io/portfolio/tags/python/">#Python</a></li>
            
            <li><a class="tag_link text-sm" href="https://kantas-spike.github.io/portfolio/tags/poetry/">#Poetry</a></li>
            
            </ul>
        </div>
        <div>
            
            
            <div class="text-right text-sm font-bold">2023/02/17
                
            </div>
            
        </div>
    </div>
</div>

  <div class="article mx-2"><p>GitHubにPythonのプログラムを公開する時に、利用しているPythonのバージョンとパッケージを指定したい。</p>
<h3 id="解決策">解決策</h3>
<p>一般的に、この用途にはパッケージマネージャーというものを利用するようだ。各種開発言語には、それぞれのパッケージマネージャーが存在する。<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></p>
<p>Pythonの場合、以下の3つが有名みたいだ。<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></p>
<ul>
<li><a href="https://www.anaconda.com/products/distribution">Anaconda</a>/<a href="https://docs.conda.io/en/latest/miniconda.html">Miniconda</a></li>
<li><a href="https://pipenv-ja.readthedocs.io/ja/translate-ja/">Pipenv</a></li>
<li><a href="https://python-poetry.org/">Poetry</a></li>
</ul>
<p>パッケージマネージャーごとに特徴があるようだが、私は以下の理由で、簡単に利用できそうなPoetryを採用する。</p>
<ul>
<li>仮想環境の利用が簡単(<code>poetry run</code>や<code>poetry shell</code>で利用やアクティベートできる)</li>
<li>Python標準の<code>pyproject.toml</code>で依存関係が定義されるためシンプル</li>
</ul>
<p><code>Poetry</code>により生成される以下のファイルをコミットしておくと、Pythonのバージョンとパッケージを指定できる。</p>
<ul>
<li><code>pyproject.toml</code></li>
<li><code>poetry.lock</code> <sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup></li>
</ul>
<h3 id="poetryを使う">Poetryを使う</h3>
<p><a href="https://jupyter.org/">Jupyter Notebook</a>の導入を例に、<code>Poetry</code>の使い方をまとめる。</p>
<h4 id="poetryのインストール"><code>Poetry</code>のインストール</h4>
<p>まずは、<code>Poetry</code>をインストールします。私の環境はmacOSなので<code>brew</code>でインストールする。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% brew install poetry
</span></span><span class="line"><span class="cl">..略..
</span></span><span class="line"><span class="cl">% poetry --version
</span></span><span class="line"><span class="cl">Poetry <span class="o">(</span>version 1.3.2<span class="o">)</span>
</span></span></code></pre></div><h4 id="プロジェクトの初期化">プロジェクトの初期化</h4>
<p>次に、プロジェクト用の作業ディレクトリを作成し、移動する。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">mkdir ~/spike/69_use-jupyter-notebook
</span></span><span class="line"><span class="cl"><span class="nb">cd</span> ~/spike/69_use-jupyter-notebook
</span></span></code></pre></div><p>そして、<code>poetry init</code>でプロジェクトを初期化する。
いくつか質問されるので、適当に回答する。(回答は<code>project.toml</code>に記録されるので、あとで簡単に修正できる。)</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% poetry init
</span></span><span class="line"><span class="cl">This <span class="nb">command</span> will guide you through creating your pyproject.toml config.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Package name <span class="o">[</span>69_use-jupyter-notebook<span class="o">]</span>:
</span></span><span class="line"><span class="cl"><span class="c1"># ..略..</span>
</span></span><span class="line"><span class="cl">Compatible Python versions <span class="o">[</span>^3.11<span class="o">]</span>:
</span></span><span class="line"><span class="cl"><span class="c1"># ..略..</span>
</span></span><span class="line"><span class="cl">Do you confirm generation? <span class="o">(</span>yes/no<span class="o">)</span> <span class="o">[</span>yes<span class="o">]</span>
</span></span></code></pre></div><h4 id="プロジェクトに合うpythonのバージョンを導入">プロジェクトに合うPythonのバージョンを導入</h4>
<p>Pythonのバージョンを<code>^3.11</code> <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup> と指定したので、<code>pyenv</code>で<code>3.11</code>のPythonを利用するようにする。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% pyenv install 3.11.2
</span></span><span class="line"><span class="cl">python-build: use openssl@1.1 from homebrew
</span></span><span class="line"><span class="cl">python-build: use readline from homebrew
</span></span><span class="line"><span class="cl">Downloading Python-3.11.2.tar.xz...
</span></span><span class="line"><span class="cl">-&gt; https://www.python.org/ftp/python/3.11.2/Python-3.11.2.tar.xz
</span></span><span class="line"><span class="cl">Installing Python-3.11.2...
</span></span><span class="line"><span class="cl"><span class="c1"># ..略..</span>
</span></span><span class="line"><span class="cl">% pyenv <span class="nb">local</span> 3.11
</span></span><span class="line"><span class="cl">% cat .python-version
</span></span><span class="line"><span class="cl">3.11
</span></span><span class="line"><span class="cl">% pyenv rehash
</span></span><span class="line"><span class="cl">% python3 --version
</span></span><span class="line"><span class="cl">Python 3.11.2
</span></span></code></pre></div><h4 id="仮想環境の設定">仮想環境の設定</h4>
<p>デフォルトでは、<code>Poetry</code>は<code>{cache-dir}/virtualenvs</code>を仮想環境とし、そこにパッケージをインストールする。</p>
<p>今回は、プロジェクト用に専用の仮想環境を作成したいと思う。
そのためには、以下を実行し設定を変更する必要がある。 <sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% poetry config --local virtualenvs.in-project <span class="nb">true</span>
</span></span><span class="line"><span class="cl">% cat poetry.toml
</span></span><span class="line"><span class="cl"><span class="o">[</span>virtualenvs<span class="o">]</span>
</span></span><span class="line"><span class="cl">in-project <span class="o">=</span> <span class="nb">true</span>
</span></span></code></pre></div><p><code>--local</code>オプションを指定して実行したので、<code>poetry.toml</code>が作成され、そこに設定内容が記録される。</p>
<h4 id="jupyter-notebookの導入">Jupyter Notebookの導入</h4>
<p>Jupyter Notebookを導入するには、<code>notebook</code>パッケージが必要である。
Poetryで、<code>notebook</code>を依存するパッケージに追加する。<sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% poetry add notebook
</span></span><span class="line"><span class="cl">Using version ^6.5.2 <span class="k">for</span> notebook
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Updating dependencies
</span></span><span class="line"><span class="cl">Resolving dependencies... <span class="o">(</span>2.1s<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Writing lock file
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Package operations: <span class="m">77</span> installs, <span class="m">0</span> updates, <span class="m">0</span> removals
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  • Installing six <span class="o">(</span>1.16.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">  • Installing attrs <span class="o">(</span>22.2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">  • Installing platformdirs <span class="o">(</span>3.0.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">..略..
</span></span></code></pre></div><p>今回は、<code>numpy</code>と<code>scipy</code>、<code>matplotlib</code>を利用したいのでインストールしたいと思う。</p>
<p>まず、<code>numpy</code>をインストールする。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% poetry add numpy
</span></span><span class="line"><span class="cl">Using version ^1.24.2 <span class="k">for</span> numpy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Updating dependencies
</span></span><span class="line"><span class="cl">Resolving dependencies... <span class="o">(</span>0.5s<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Writing lock file
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Package operations: <span class="m">1</span> install, <span class="m">0</span> updates, <span class="m">0</span> removals
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  • Installing numpy <span class="o">(</span>1.24.2<span class="o">)</span>
</span></span><span class="line"><span class="cl">%
</span></span></code></pre></div><p>次に、<code>scipy</code>をインストールする。しかし、エラーが発生した。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% poetry add scipy
</span></span><span class="line"><span class="cl">Using version ^1.10.1 <span class="k">for</span> scipy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Updating dependencies
</span></span><span class="line"><span class="cl">Resolving dependencies... <span class="o">(</span>0.0s<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">The current project<span class="err">&#39;</span>s Python requirement <span class="o">(</span>&gt;<span class="o">=</span>3.11,&lt;4.0<span class="o">)</span> is not compatible with some of the required packages Python requirement:
</span></span><span class="line"><span class="cl">  - scipy requires Python &lt;3.12,&gt;<span class="o">=</span>3.8, so it will not be satisfied <span class="k">for</span> Python &gt;<span class="o">=</span>3.12,&lt;4.0
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Because no versions of scipy match &gt;1.10.1,&lt;2.0.0
</span></span><span class="line"><span class="cl"> and scipy <span class="o">(</span>1.10.1<span class="o">)</span> requires Python &lt;3.12,&gt;<span class="o">=</span>3.8, scipy is forbidden.
</span></span><span class="line"><span class="cl">So, because 69-use-jupyter-notebook depends on scipy <span class="o">(</span>^1.10.1<span class="o">)</span>, version solving failed.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  • Check your dependencies Python requirement: The Python requirement can be specified via the <span class="sb">`</span>python<span class="sb">`</span> or <span class="sb">`</span>markers<span class="sb">`</span> properties
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    For scipy, a possible solution would be to <span class="nb">set</span> the <span class="sb">`</span>python<span class="sb">`</span> property to <span class="s2">&#34;&gt;=3.11,&lt;3.12&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    https://python-poetry.org/docs/dependency-specification/#python-restricted-dependencies,
</span></span><span class="line"><span class="cl">    https://python-poetry.org/docs/dependency-specification/#using-environment-markers
</span></span><span class="line"><span class="cl">%
</span></span></code></pre></div><p>これは、プロジェクトが許容する<code>python</code>のバージョンと、<code>scipy</code>が許容する<code>python</code>のバージョンがマッチしていないため、エラーが発生している。</p>
<p>プロジェクトが許容する<code>python</code>のバージョンは<code>project.toml</code>に記載されている。
今回は<code>python</code>のバージョンが、<code>python = &quot;^3.11&quot;</code>となっており、これは<code>python</code>のバージョンが<code>&gt;=3.11.0 &lt; 4.0</code>を意味する。</p>
<p>しかし、今インストールしようとしている<code>scipy</code>は<code>python</code>の<code>&lt;3.12,&gt;=3.8</code>バージョンまでに対応している。<sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup> そのため、ミスマッチが発生している。</p>
<p>これを修正するには、プロジェクトが許容する<code>python</code>のバージョンを厳密にする必要がある。
まだ、リリースもされていない<code>python</code>のバージョンは無視して、以下のように<code>python = &quot;~3.11&quot;</code>とし、<code>python</code>の<code>&gt;=3.11.0 &lt; 3.12</code>を対象とした。 <sup id="fnref:8"><a href="#fn:8" class="footnote-ref" role="doc-noteref">8</a></sup></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="c"># ..略..</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">tool</span><span class="p">.</span><span class="nx">poetry</span><span class="p">.</span><span class="nx">dependencies</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">python</span> <span class="p">=</span> <span class="s2">&#34;~3.11&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c"># ..略..</span>
</span></span></code></pre></div><p>再度、<code>scipy</code>をインストールする。今度はちゃんとインストールできる。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% poetry add scipy
</span></span><span class="line"><span class="cl">Using version ^1.10.1 <span class="k">for</span> scipy
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Updating dependencies
</span></span><span class="line"><span class="cl">Resolving dependencies... <span class="o">(</span>0.5s<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Writing lock file
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Package operations: <span class="m">1</span> install, <span class="m">0</span> updates, <span class="m">0</span> removals
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  • Installing scipy <span class="o">(</span>1.10.1<span class="o">)</span>
</span></span></code></pre></div><p>最後に、<code>matplotlib</code>をインストールする。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% poetry add matplotlib
</span></span><span class="line"><span class="cl">Using version ^3.7.0 <span class="k">for</span> matplotlib
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Writing lock file
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Package operations: <span class="m">7</span> installs, <span class="m">0</span> updates, <span class="m">0</span> removals
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  • Installing contourpy <span class="o">(</span>1.0.7<span class="o">)</span>
</span></span><span class="line"><span class="cl">  • Installing cycler <span class="o">(</span>0.11.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">  • Installing fonttools <span class="o">(</span>4.38.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">  • Installing kiwisolver <span class="o">(</span>1.4.4<span class="o">)</span>
</span></span><span class="line"><span class="cl">  • Installing pillow <span class="o">(</span>9.4.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">  • Installing pyparsing <span class="o">(</span>3.0.9<span class="o">)</span>
</span></span><span class="line"><span class="cl">  • Installing matplotlib <span class="o">(</span>3.7.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">%
</span></span></code></pre></div><p>プロジェクトディレクトリ内に、仮想環境用の<code>.venv</code>ディレクトリが作成され、そこにパッケージがインストールされる。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% ls .venv
</span></span><span class="line"><span class="cl">bin             etc             lib             pyvenv.cfg      share
</span></span></code></pre></div><p>そして、<code>pyproject.toml</code>には<code>notebook</code>パッケージとそのバージョンが記録される。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-toml" data-lang="toml"><span class="line"><span class="cl"><span class="c"># ..略..</span>
</span></span><span class="line"><span class="cl"><span class="p">[</span><span class="nx">tool</span><span class="p">.</span><span class="nx">poetry</span><span class="p">.</span><span class="nx">dependencies</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="nx">python</span> <span class="p">=</span> <span class="s2">&#34;~3.11&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">notebook</span> <span class="p">=</span> <span class="s2">&#34;^6.5.2&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">numpy</span> <span class="p">=</span> <span class="s2">&#34;^1.24.2&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nx">scipy</span> <span class="p">=</span> <span class="s2">&#34;^1.10.1&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c"># ..略..</span>
</span></span></code></pre></div><p>さらに、<code>poetory.lock</code>に依存するパッケージも含めた詳細なパッケージの情報が記録される。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">head poetry.lock
</span></span><span class="line"><span class="cl"><span class="c1"># This file is automatically @generated by Poetry and should not be changed by hand.</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">[[</span>package<span class="o">]]</span>
</span></span><span class="line"><span class="cl"><span class="nv">name</span> <span class="o">=</span> <span class="s2">&#34;anyio&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">version</span> <span class="o">=</span> <span class="s2">&#34;3.6.2&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">description</span> <span class="o">=</span> <span class="s2">&#34;High level compatibility layer for multiple asynchronous event loop implementations&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">category</span> <span class="o">=</span> <span class="s2">&#34;main&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">optional</span> <span class="o">=</span> <span class="nb">false</span>
</span></span><span class="line"><span class="cl">python-versions <span class="o">=</span> <span class="s2">&#34;&gt;=3.6.2&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nv">files</span> <span class="o">=</span> <span class="o">[</span>
</span></span></code></pre></div><p>もし、GitHubにプロジェクトを公開する場合、<code>poetry.lock</code>を登録しておけば、
プロジェクトをクローンしたユーザーは、以下のコマンドにより、<code>poetry.lock</code>に記載されたバージョンの依存関係も含む全パッケージをインストールできる。<sup id="fnref:9"><a href="#fn:9" class="footnote-ref" role="doc-noteref">9</a></sup></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">poetry install
</span></span></code></pre></div><h4 id="jupyter-notebookの実行">Jupyter Notebookの実行</h4>
<p><code>poetry run</code>の後に、コマンドを実行すると、プロジェクトの仮想環境で実行される。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% poetry run jupyter notebook
</span></span><span class="line"><span class="cl"><span class="o">[</span>I 11:21:43.847 NotebookApp<span class="o">]</span> Writing notebook server cookie secret to /Users/kanta/Library/Jupyter/runtime/notebook_cookie_secret
</span></span><span class="line"><span class="cl"><span class="o">[</span>I 11:21:44.345 NotebookApp<span class="o">]</span> Serving notebooks from <span class="nb">local</span> directory: /Users/kanta/spike/69_use-jupyter-notebook
</span></span><span class="line"><span class="cl"><span class="o">[</span>I 11:21:44.345 NotebookApp<span class="o">]</span> Jupyter Notebook 6.5.2 is running at:
</span></span><span class="line"><span class="cl"><span class="o">[</span>I 11:21:44.345 NotebookApp<span class="o">]</span> http://localhost:8888/?token<span class="o">=</span>3f11e224193b1fe12c2241acf4f8a47eec902761062a8fe8
</span></span><span class="line"><span class="cl"><span class="o">[</span>I 11:21:44.345 NotebookApp<span class="o">]</span>  or http://127.0.0.1:8888/?token<span class="o">=</span>3f11e224193b1fe12c2241acf4f8a47eec902761062a8fe8
</span></span><span class="line"><span class="cl"><span class="o">[</span>I 11:21:44.345 NotebookApp<span class="o">]</span> Use Control-C to stop this server and shut down all kernels <span class="o">(</span>twice to skip confirmation<span class="o">)</span>.
</span></span><span class="line"><span class="cl"><span class="c1"># ..略..</span>
</span></span></code></pre></div><p>また、<code>poetry shell</code>で仮想環境をアクティベートしてから、<code>jupyter notebook</code>を実行しても同様になる。<sup id="fnref:10"><a href="#fn:10" class="footnote-ref" role="doc-noteref">10</a></sup></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">% poetry shell
</span></span><span class="line"><span class="cl">Spawning shell within /Users/kanta/spike/69_use-jupyter-notebook/.venv
</span></span><span class="line"><span class="cl">% emulate bash -c <span class="s1">&#39;. /Users/kanta/spike/69_use-jupyter-notebook/.venv/bin/activate&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">(</span>69-use-jupyter-notebook-py3.11<span class="o">)</span> % jupyter notebook
</span></span><span class="line"><span class="cl"><span class="o">[</span>I 11:23:35.318 NotebookApp<span class="o">]</span> Serving notebooks from <span class="nb">local</span> directory: /Users/kanta/spike/69_use-jupyter-notebook
</span></span><span class="line"><span class="cl"><span class="o">[</span>I 11:23:35.318 NotebookApp<span class="o">]</span> Jupyter Notebook 6.5.2 is running at:
</span></span><span class="line"><span class="cl"><span class="o">[</span>I 11:23:35.319 NotebookApp<span class="o">]</span> http://localhost:8888/?token<span class="o">=</span>a8feeef6303a95334b208be924ee88542bd9c3bdd9676870
</span></span><span class="line"><span class="cl"><span class="o">[</span>I 11:23:35.319 NotebookApp<span class="o">]</span>  or http://127.0.0.1:8888/?token<span class="o">=</span>a8feeef6303a95334b208be924ee88542bd9c3bdd9676870
</span></span><span class="line"><span class="cl"><span class="o">[</span>I 11:23:35.319 NotebookApp<span class="o">]</span> Use Control-C to stop this server and shut down all kernels <span class="o">(</span>twice to skip confirmation<span class="o">)</span>.
</span></span></code></pre></div><h3 id="参考">参考</h3>
<ul>
<li><a href="https://qiita.com/akkey2475/items/5b2813e62303a9c75813">バージョン管理ツール、パッケージ管理ツールの種類をまとめました - Qiita</a></li>
<li><a href="https://qiita.com/hi-asano/items/831c6c3147ae3d7049f9">Pythonパッケージ管理ツール個人的まとめ - Qiita</a></li>
<li><a href="https://blog.ymyzk.com/2017/12/how-packages-are-installed/">パッケージマネージャがパッケージをインストールする仕組み – ymyzk’s blog</a></li>
<li><a href="https://book.st-hakky.com/docs/poetry-intro/">poetryによるパッケージの依存関係の管理 | Hakky Handbook</a></li>
<li><a href="https://pipenv-ja.readthedocs.io/ja/translate-ja/">Pipenv: 人間のためのPython開発ワークフロー — pipenv 2018.11.27.dev0 ドキュメント</a></li>
<li><a href="https://kennethreitz.org/essays/2016/02/25/a-better-pip-workflow">A Better Pip Workflow™ — Kenneth Reitz</a></li>
<li><a href="https://tech.515hikaru.net/post/2019-11-23-pyproject/">pyproject.toml とは何か | I Was Perfect</a></li>
<li><a href="https://python-poetry.org/docs/basic-usage/">Basic usage | Documentation | Poetry - Python dependency management and packaging made easy</a></li>
<li><a href="https://python-poetry.org/docs/configuration/#virtualenvsin-project">Configuration | Documentation | Poetry - Python dependency management and packaging made easy</a></li>
<li><a href="https://python-poetry.org/docs/dependency-specification/">Dependency specification | Documentation | Poetry - Python dependency management and packaging made easy</a></li>
<li><a href="https://jupyter.org/install#jupyter-notebook">Project Jupyter | Installing Jupyter</a></li>
</ul>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>パッケージマネージャーという用語には、いくつか<a href="https://qiita.com/akkey2475/items/5b2813e62303a9c75813">分類</a>があるようだ。ここでは、Python言語のパッケージ管理ツールを話題にしている。&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>昔からpipとrequirements.txtを利用するシンプルな方法が昔から利用されていたそうだが、この方法は複雑なパッケージの依存関係に対応しにくいそうだ。&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>依存関係のあるパッケージのバージョンを指定する場合は<code>poetry.lock</code>もコミットする&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>バージョン3.11以上、4.0未満の意味&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5">
<p><code>--local</code>オプションなしで設定すると、すべてのプロジェクト共通の設定になる。&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6">
<p><code>add</code>で指定したパッケージ名からパッケージと依存するパッケージの適切なバージョン情報を取得して、インストールする。&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7">
<p>まだリリースもされていない<code>&lt;4.0</code>のバージョンなんて対応できる訳ないですよね&#160;<a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:8">
<p>バージョンの指定方法については、<a href="https://python-poetry.org/docs/dependency-specification/">Dependency specification</a>を参照&#160;<a href="#fnref:8" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:9">
<p><code>poetry.lock</code>が存在しない場合は、<code>pyproject.toml</code>に記載されたパッケージと、依存するパッケージの最新バージョンがインストールされる&#160;<a href="#fnref:9" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:10">
<p>起動したシェルを抜けるには、<code>deactivate</code>を実行するか<code>exit</code>(C-dでも良い)を実行する&#160;<a href="#fnref:10" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div></div>
  <div class="mt-6">
    <div class="border-t-2 border-primary-dark px-2 pt-2 text-right">
        <span class="text-sm">作成日: 2023/02/17</span></div>
</div>

</div>


    </main><footer class="bg-primary-dark text-center text-on-primary-dark fixed bottom-0 w-full h-8">
    <div class="container mx-auto grid grid-cols-3">
        <div class="col-start-1 col-span-2 ml-2 md:ml-0 md:col-start-2 md:col-span-1">
            <div class="text-left md:text-center text-sm pt-2">© 2022 kanta&#39;s spike</div>
        </div>
        <div class="col-start-3 flex justify-end gap-2 mr-2">
            
                
            <a title="Twitter" class="text-2xl" href="https://twitter.com/KantasSpike"><i class="fa-brands fa-twitter-square"></i></a>
                
            <a title="Youtube" class="text-2xl" href="https://www.youtube.com/channel/UCnVBuUGMYAt7ZuIkadxnMfw"><i class="fa-brands fa-youtube-square"></i></a>
                
            <a title="GitHub" class="text-2xl" href="https://github.com/kantas-spike"><i class="fa-brands fa-github-square"></i></a>
                
            <a title="Blog" class="text-2xl" href="https://kantas-spike.github.io/portfolio/"><i class="fa-solid fa-square-arrow-up-right"></i></a>
                
            
        </div>
    </div>
</footer> 




<script defer type="text/javascript" src="/portfolio/js/search-form.07066240729fbbddf7f08e0938e5a7a060da185ec1c29e438984cfa6c2ff2386dd2ef58d9c7af295b66d187cc9c180f4aa62433709f8bf8813c39c1e239b641e.js" integrity="sha512-BwZiQHKfu9338I4JOOWnoGDaGF7Bwp5DiYTPpsL/I4bdLvWNnHrylbZtGHzJwYD0qmJDNwn4v4gTw5weI5tkHg=="></script></body>
</html>
